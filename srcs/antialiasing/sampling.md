## 什么是采样
在理解“反走样”之前，我们需要先理解如何进行“采样”，才能找到“走样”的原因，从而更好地解决问题。

计算机只能存储和处理**有限**的内容，因此无法表示**连续**的东西。最为典型的例子是实数轴：
实数是没有空隙的，整个数轴上不存在“漏洞”。但是计算机无法表示出实数轴上的所有实数。
（比如 $\pi$ ，我们没法存储一个变量，使它就是 $\pi$ 本身，分毫不差。我们通常存储的都是一个 $\pi$ 的近似值，比如 $3.14159265$ ）
真实世界中很多东西都是连续的，比如我所说的一段话，因而我们没法把“这段话”本身存入计算机。为了尽可能准确地记录这些信息，我们需要进行**采样**，也就是变为**离散**的形式。

作为简化，我们假定对一个函数进行采样：

![Screenshot from 2021-10-19 21-02-19.png](https://i.loli.net/2021/10/19/8NuMPiTZCGB65Ke.png)

如图，这是一个正弦函数。这个连续函数难以被存储，所以我们需要对其进行采样，从而变为有限的，离散的形式。我们假设每隔 $0.5$ 进行一次采样：

![Screenshot from 2021-10-19 21-04-50.png](https://i.loli.net/2021/10/19/3JsHp8AqvQha1Z7.png)

根据这些采样点，我们就可以尝试恢复出之前的函数值。由于我们不知道两点之间的函数应该画成什么样，我们不妨假定点与点之间的i连线全部为直线：

![Screenshot from 2021-10-19 21-06-31.png](https://i.loli.net/2021/10/19/FKETsWiRagBQ3kA.png)

可以看到：此时的直线分段函数并不是 $sinx$ ，但是二者非常的接近。在大部分的情况下，我们可以认为这是一个 $sinx$ 的不错的替代品。
例如：在进行语音通话的时候，我们并不需要将对方的声音无损地传输过去，只要对方可以听清，有一些噪音或误差是可以容忍的。

对于图形学来说，采样很多时候表现为空间上的采样而不是时间上的采样。
拍照就是一个在空间上采样的典型例子。我们的相机会有很多感光元件（但是依然是有限个数的），这些元件接受外部的光照，然后形成对应的“像素”。
这些像素就是采样的结果。如果你将图片放大到一定程度，你就会看到这些像素间的边界。

## 卷积与冲激函数
### 卷积运算
采样中，我们会用到一个非常重要的运算：卷积。

卷积被定义为两个函数乘积的积分： $\int_{-\infty}^{\infty} f(\tau)g(\tau - t)d\tau$ 。在图像上我们可以这样理解：

+ 将函数 $g(\tau)$ 向左平移，得到 $g(\tau + t)$ ，并进行翻转，得到 $g(t - \tau)$
+ 不断平移 $f(\tau)$ ，两个函数交汇的时候，求出相交面积（也就是函数乘积的积分值），作为该点的卷积值

卷积可以被理解为某种意义上的加权平均。如果连续形式的卷积让你感到难以理解，你可以看看离散形式的卷积： $\sum_{m = -\infty}^{\infty} f(m)g(n - m)$ 。

我们以 $f(m) = \frac{1}{3}, m = {-1, 0, 1}$ 为例，来看其对于 $g(m) = m, m = {1, 2, 3, 4, 5}$ （我们把定义域外的值全部认为0）的卷积：

+ 当 $n = 1$ 时，卷积的结果为 $\frac{1}{3}(0 + 1 + 2) = 1$ ，其恰好为 $0, 1, 2$ 的平均值；
+ 当 $n = 2$ 时，卷积的结果为 $\frac{1}{3}(1 + 2 + 3) = 2$ ，其恰好为 $1, 2, 3$ 的平均值；
+ 当 $n = 3$ 时，卷积的结果为 $\frac{1}{3}(2 + 3 + 4) = 3$ ，其恰好为 $2, 3, 4$ 的平均值；
+ $\dots$

这个卷积核（即 $f(m)$ ）所做的事，就是取第 $n$ 个数，并与相邻的两个数求平均。你也可以改变卷积核的形式，从而完成如加权平均这样的运算。
总的来说，卷积就是将一个函数按照另一个函数进行加权求和的操作。

### 冲激函数
到目前为止，我们都没有给“采样”下一个正式的定义。我们只是从直观的角度理解了采样。现在，借助于卷积运算，我们重新来定义采样。

对函数 $f(t)$ 在 $t$ 点的采样可以被写为两个函数的卷积： $\int_{-\infty}^{\infty} \delta(\tau)f(\tau - t)d\tau$ ，其中 $\delta(t) = 0, t \ne 0$ ，
并且满足 $\int_{-\infty}^{\infty} \delta(t)dt = 1$ 。这个函数被称为冲激函数，其在 $t = 0$ 上的取值为无穷，且与x轴围成的面积为1。

不难想象：单个冲激函数与函数进行卷积，我们将会得到函数在 $t$ 处的取值（这是两个函数相交部分的面积）：

![Screenshot from 2021-10-19 22-08-26.png](https://i.loli.net/2021/10/19/aVSAigODUte2Z5v.png)

随着 $\delta(t)$ 的平移，我们可以逐渐还原出整个函数的原貌。由于计算机无法计算整个实数域上的积分，我们不妨改用离散的形式。
我们定义离散的冲激函数仅在 $t = 0$ 时等于1，其他时候为全0。并且规定每次平移的间隔（如每隔0.2进行一次运算），此时我们就得到了采样的形式：

![Screenshot from 2021-10-19 22-18-05.png](https://i.loli.net/2021/10/19/FJE7uNmdqp21LGz.png)

不难看出来，每次平移的间隔会影响我们采样的质量。当这个间隔无限趋近于0时，此时的采样等同于连续函数的卷积，此时我们将会得到原本的函数。

## 傅立叶变换
### 周期与频率
一个函数被称为周期函数，当且仅当 $f(x) = f(x + T)$ 。此时 $T$ 被称为函数周期。最典型的周期函数是三角函数，比如 $sin(x)$ 。这个函数的最小正周期为 $2\pi$ 
（这里使用的说法是“最小正周期”，是因为任意的 $2n\pi, n \in Z$ 都是 $sin(x)$ 的周期）。

函数的频率被定义为函数周期的倒数： $f = \frac{1}{T}$ 。频率的含义指的是在单位时间内某件事发生的次数。比如人的心率为 $120 bpm$ （这个单位的含义是次/每分钟，也是频率的一种体现），
就意味着“心跳”这件事每分钟发生120次。

从上面的例子可以看出来：频率越高，事情发生的就越平凡，变化就会越剧烈。一个心率为 $130 bpm$ 的人比起一个心率只有 $90 bpm$ 的人看起来会更加的面红耳赤；从函数的视角来看，
一个周期函数频率越高，就意味着同样的时间里，他的变化更剧烈：

![Screenshot from 2021-10-19 22-39-17.png](https://i.loli.net/2021/10/19/RXqeaWGcvm7ofkO.png)

上图是 $sin(x)$ 和 $sin(10\pi x)$ 的图像，可以看到 $sin(10\pi x)$ 的版本在一小段内发生了剧烈的震荡，而 $sin(x)$ 则平缓的多。

在对图像进行采样的时候，我们所使用的指标往往不再是时间，而是距离。如果同样的距离内灰度的变动较大，我们认为该位置的信号频率是比较高的。
低频的图像信号往往意味着图像的内部（比如一张人脸的照片，如果肌肤比较光滑且没有高光，那么这些皮肤的颜色应该都是相近的），而高频往往出现在图像的边界上（比如蓝色的衣服和黄色的皮肤，交界处的变动是非常剧烈的）。

### 函数正交
我们在线性代数部分介绍了空间中的基，以及正交基的概念。这些概念都是在有限空间（比如三维空间）中定义的。如果一个空间的维度是三维，那么我们只需要找到三个向量作为基，就可以张成出整个空间。
这不禁会引发我们的思考：如果空间从有限维变为无限维，我们是否可以通过无限个基向量长成出整个空间？更进一步地：我们的空间是否可以不是一个实数空间，而是一个更加一般的空间（如函数空间）？

这样的空间非常抽象，但确实是存在的，他的名字叫做希尔伯特无穷维空间。希尔伯特空间是欧几里德空间的推广，他是一个无穷的函数空间，但同样存在着距离和角的概念（由此我们可以定义两个函数的正交性）。

> 希尔伯特空间是一个非常深奥的数学概念。考虑到大部分人（包括我自己）都不是数学系的学生，我们在此仅仅只是宣告他的存在，而不进一步深究他的原理和性质（除了函数的正交）。
> 如果你希望了解更进一步的知识，请参见参考资料。

在有限的向量空间中，我们定义了向量的点乘：将对应位置的数字相乘，并将结果相加。如果点乘的结果为0，那么我们认为两个向量正交。
在希尔伯特空间中，两个函数的正交有着类似的性质：我们将“对应位置的数字相乘”这样的离散表述换为连续的表述： 两个函数的点乘表示为 $\int_a^bf(x)g(x)dx$ 。
如果点乘的结果为0，我们就称这两个函数在区间 $[a, b]$ 上正交。

我们可以很容易地验证： $1, sin(nx), cos(nx)$ 之间在 $[-T, T]$ 上互相是正交的（如果是两个 $sin(nx)$ 判断正交，你需要将其标记为 $sin(n_1x)$ 和 $sin(n_2x)$ ）。

### 傅立叶级数与傅立叶变换
综合我们之前所有的内容，我们现在发现了一个惊人的事实：所有的函数都可以由一系列的三角函数叠加在一起表示出来。这样的表示方式被称为傅立叶级数。
傅立叶级数的公式如下：

$$
f(x) = a + \sum_{n = 1}^N (a_ncos(2\pi \frac{n}{N}x) + b_nsin(2\pi \frac{n}{N}x))
$$

由于三角函数的周期性，我们只需要求出其中一个周期的值即可。为此，我们将原本的频率 $f$ 替换为 $\frac{n}{N}$ ，随着 $N$ 趋近于无穷，我们的基的数量也趋近于无穷，
所以我们只需要在一个周期内无限细分下去即可。

我们并没有完成他的全部推导，因为 $sin, cos$ 的系数我们并不知道。我们需要求出每一个基所对应的系数。
我们需要将函数“投影”在不同的基函数上，为此我们需要使用点乘。因为投影被表示为 $||\vec w|| = \frac{\vec u \cdot \vec v}{||\vec u||}$ ，
我们使用函数的表达来替换上面的式子： $a_n = \frac{1}{\pi}\int_N f(x)cos(2\pi \frac{n}{N}x)dx, b_n = \frac{1}{\pi}\int_N f(x)sin(2\pi \frac{n}{N}x)dx$
唯一的例外是当基函数取1的时候。此时的积分值为周期长度 $2\pi$ ，正好是 $a_n$ 系数分母的两倍。所以我们不妨认为 $a$ 为 $a_0$ ，使用相同的公式计算：

$$
f(x) = \frac{a_0}{2} + \sum_{n = 1}^N (a_ncos(2\pi \frac{n}{N}x) + b_nsin(2\pi \frac{n}{N}x))
$$
 
## 走样产生的原因


## 参考资料
+ [GAMES101-现代计算机图形学入门-闫令琪](https://www.bilibili.com/video/BV1X7411F744?p=6)
+ [卷积 - 维基百科，自由的百科全书](https://zh.wikipedia.org/wiki/%E5%8D%B7%E7%A7%AF)
+ [冲激响应 - 维基百科，自由的百科全书](https://zh.wikipedia.org/wiki/%E5%86%B2%E6%BF%80%E5%93%8D%E5%BA%94)
+ [希尔伯特空间- 维基百科，自由的百科全书](https://zh.wikipedia.org/wiki/%E5%B8%8C%E5%B0%94%E4%BC%AF%E7%89%B9%E7%A9%BA%E9%97%B4)