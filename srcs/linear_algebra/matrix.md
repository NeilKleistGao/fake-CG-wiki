## 什么是矩阵
数学上，一个 $m\times n$ 的矩阵是一个由m行n列元素排列成的矩形阵列。矩阵里的元素可以是数字、符号或数学式。

目前为止，我们所研究的矩阵的范围仅限于实矩阵（即矩阵里的元素都是实数）。

以下是一个 $3 \times 3$ 的矩阵：

$$
\begin{bmatrix}
    1 & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
\end{bmatrix}
$$

我们也可以认为行向量是一个 $1 \times n$ 的矩阵，而列向量一个 $n \times 1$ 的矩阵。

## 矩阵乘法
矩阵的乘法可以按照不同的方式来理解。

我们以

$$
\begin{bmatrix}
    1 & 2 & 3 \\
    2 & 1 & 2 \\
    1 & 1 & 1
\end{bmatrix}
\begin{bmatrix}
    2 & 1 & 3 \\
    2 & 2 & 2 \\
    1 & 2 & 3
\end{bmatrix}
$$

为例，讲解矩阵乘法的几种理解方式。

### 向量的点乘
最常规的矩阵乘法是将第一个矩阵拆分为行向量，将第二个矩阵拆分为列向量，然后分别进行点乘：

$$
\begin{bmatrix}
    1 & 2 & 3 \\
    2 & 1 & 2 \\
    1 & 1 & 1
\end{bmatrix}
\begin{bmatrix}
    2 & 1 & 3 \\
    2 & 2 & 2 \\
    1 & 2 & 3
\end{bmatrix}
= 
\begin{bmatrix}
    \begin{bmatrix}1 & 2 & 3\end{bmatrix} \\
    \begin{bmatrix}2 & 1 & 2\end{bmatrix} \\
    \begin{bmatrix}1 & 1 & 1\end{bmatrix}
\end{bmatrix}
\begin{bmatrix}
    \begin{bmatrix}2\\2\\1\end{bmatrix}
    \begin{bmatrix}2\\2\\2\end{bmatrix}
    \begin{bmatrix}1\\2\\3\end{bmatrix}
\end{bmatrix}
$$

结果矩阵中 $a_{ij}$ 的结果就是第i个行向量和第j个列向量的点乘：

$$
\begin{bmatrix}
    1 & 2 & 3 \\
    2 & 1 & 2 \\
    1 & 1 & 1
\end{bmatrix}
\begin{bmatrix}
    2 & 1 & 3 \\
    2 & 2 & 2 \\
    1 & 2 & 3
\end{bmatrix}
= 
\begin{bmatrix}
    9 & 11 & 14 \\
    8 & 10 & 10 \\
    5 & 6 & 6
\end{bmatrix}
$$

上例中的 $9$ ，不难发现其实是第一行向量和第一列向量点成的结果：

$$
a_{11} = \begin{bmatrix}1 & 2 & 3\end{bmatrix} \cdot \begin{bmatrix}2\\2\\1\end{bmatrix} = 2 + 4 + 3 = 9
$$

根据上面的乘法方式，我们不难看出：如果两个矩阵相乘，其大小必须是 $M \times K$ 和 $K \times N$ 的，即第一个矩阵的列数要和第二个矩阵的行数相等。
矩阵乘法的结果是 $M \times N$ 的。

我们也可以得到另一个信息：矩阵乘法**并不一定满足交换率**。在不是方阵的情况下，两个矩阵交换顺序甚至无法相乘！你也可以交换上面的两个矩阵的顺序，看看结果是否一致。
你也可以尝试寻找两个交换后结果不变的矩阵，并分析为什么。

### 列向量的线性组合
我们先考虑第二个矩阵的第一列：

$$
\begin{bmatrix}
    1 & 2 & 3 \\
    2 & 1 & 2 \\
    1 & 1 & 1
\end{bmatrix}
\begin{bmatrix}2\\2\\1\end{bmatrix}
$$

根据上面的推导，这样的乘法是合法的，我依然可以采取向量点乘的方式得到结果：

$$
\begin{bmatrix}
    1 & 2 & 3 \\
    2 & 1 & 2 \\
    1 & 1 & 1
\end{bmatrix}
\begin{bmatrix}2\\2\\1\end{bmatrix} = 
\begin{bmatrix}9\\8\\5\end{bmatrix}
$$

如果我们将第一个矩阵写成三个列向量的形式，我们会发现：

$$
\begin{bmatrix}9\\8\\5\end{bmatrix}=
2\begin{bmatrix}1\\2\\1\end{bmatrix} +
2\begin{bmatrix}2\\1\\1\end{bmatrix} +
\begin{bmatrix}3\\2\\1\end{bmatrix}
$$

对于剩下的两列，我们也可以用类似的方法求出。这里就可以得出我们的结论：矩阵乘法结果的第i列，可以视为第一个矩阵列向量的线性组合。

更进一步地，我们希望推广出一个更通用的结论：**矩阵右乘（即把矩阵放在右边）的本质是对左侧矩阵的列进行线性组合**。

### 行向量的线性组合
同理，我们也可以尝试如下的形式：

$$
\begin{bmatrix}1 & 2 & 3\end{bmatrix}
\begin{bmatrix}
    2 & 1 & 3 \\
    2 & 2 & 2 \\
    1 & 2 & 3
\end{bmatrix}
=
\begin{bmatrix}9 & 11 & 14\end{bmatrix}
$$

类似于类的情况，我们也可以将矩阵乘法视为行向量的线性组合，更具体的：矩阵乘法结果的第i行，可以视为第二个矩阵行向量的线性组合。
同理我们也可以得到：**矩阵左乘（即把矩阵放在左边）的本质是对右侧矩阵的行进行线性组合**。

### 分块乘法
我们还可以将上述的乘法写为如下的形式：

$$
\begin{bmatrix}
    A_{2\times 2} & A_{2\times 1} \\
    A_{1\times 2} & A_{1\times 1} \\
\end{bmatrix}
\begin{bmatrix}
    B_{2\times 2} & B_{2\times 1} \\
    B_{1\times 2} & B_{1\times 1} \\
\end{bmatrix}
$$

其中： 

$$ 
A_{2\times 2} = 
\begin{bmatrix}
    2 & 1 \\
    2 & 2 
\end{bmatrix}
$$

$$ 
A_{2\times 1} = 
\begin{bmatrix}
    3 \\
    2
\end{bmatrix}
$$

$$ 
A_{1\times 2} = 
\begin{bmatrix}
    1 & 1
\end{bmatrix}
$$

$$ 
A_{1\times 1} = 
\begin{bmatrix}
    3
\end{bmatrix}
$$

同理你也可以对第二个矩阵进行相应的拆分。这种形式被称为分块矩阵乘法。现在，你需要做的仅仅只是把元素从实数换成矩阵，然后沿用之前的所有运算法则。
你可以进行任意的拆分，只要保证拆分后各个元素依然可以相乘即可。

这种形式可以有效化减复杂的矩阵，在一些算法优化和证明中有着不错的应用。

## 矩阵转置
对于如下的一个矩阵

$$
\begin{bmatrix}
    2 & 1 & 3 \\
    2 & 2 & 2 
\end{bmatrix}
$$

你可以把它写在纸上，并将纸张顺时针旋转90度，最后将它翻面。此时我们写下“新矩阵”中对应位置上的数字：

$$
\begin{bmatrix}
    2 & 2 \\
    1 & 2 \\
    3 & 2
\end{bmatrix}
$$

这个过程我们称之为矩阵的转置。如果矩阵是方阵，你可以更简单地，沿对角线交换两侧的元素，从而完成转置的操作。

更正式地，数学上转置的解释为：对一个 $M \times N$ 的矩阵A，其转置的结果 $A^T$ 是一个 $N \times M$ 的矩阵，其中的元素 $a'_{ij} = a_{ji}$ 。

回顾一下矩阵的乘法，如果对矩阵乘法的结果取转置： $(AB)^T$ ，为了保证转置后两个矩阵依然可以相乘，我们需要交换矩阵的顺序： $(AB)^T = B^TA^T$ 。你可以自己验证一下这个结论。

## 方程组与矩阵
现在让我们暂时先放下沉重的负担，回忆一下小学（或者初中）时代的美好童年（如果你的童年并不美好，请允许我们对此表示抱歉，相信你会有一个更美好的未来XD）：

$$
\begin{array}{l}
x + y = 2 \\
-x + 2y = 1
\end{array}
$$

这是一个很常见的二元一次方程组，我们很容易可以求得方程组的解： $x = -1, y = 1$ ，并画出平面内的图像：

![Screenshot from 2021-09-16 14-47-36.png](https://i.loli.net/2021/09/16/3VboCLFQfSmePA6.png)

除了消元的做法外，更直观的方法就是像这样把图像画出，然后找到两条直线的焦点。

好了，回忆到此结束（非常抱歉这个环节如此短暂）！我们的重点在于：我们可以使用矩阵表现出这个方程组：

$$
\begin{bmatrix}
    1 & 1 \\
    -1 & 2 
\end{bmatrix}
\begin{bmatrix}
    x \\ y
\end{bmatrix}
=
\begin{bmatrix}
    2 \\ 1
\end{bmatrix}
$$

或者更一般地，我们写作 $A \vec x = \vec b$ ，其中A为方程组的系数矩阵， $\vec x$ 为未知数向量， $\vec b$ 为结果向量。

现在，结合矩阵乘法，我们可以给出方程组的另一个解释：找到两个系数x和y，使得两个列向量的线性组合等于 $\vec b$ ：

![Screenshot from 2021-09-16 14-52-25.png](https://i.loli.net/2021/09/16/PBx12uwLFmkXTGH.png)

在实际运算中，我们还是更偏爱于消元的做法。接下来我们会讨论如何在矩阵形式下对方程组进行消元。

## 矩阵消元
我们来解一个三元的方程组：

$$
\begin{bmatrix}
    1 & 2 & 3 \\
    2 & 1 & 2 \\
    1 & 1 & 1
\end{bmatrix}
\begin{bmatrix}
    x \\ y \\ z
\end{bmatrix}
=
\begin{bmatrix}
    9 \\ 8 \\ 5
\end{bmatrix}
$$

其中，未知数向量对于我们来说用处不大（无论写作xyz或是写作abc甚至rgb对于我们解这个方程都没有影响）。所以我们更倾向于用这个矩阵：

$$
\begin{bmatrix}
    1 & 2 & 3 & 9 \\
    2 & 1 & 2 & 8 \\
    1 & 1 & 1 & 5
\end{bmatrix}
$$

这个矩阵叫做方程的增广矩阵，即我们把方程的常数项与系数矩阵进行了合并。
接下来我们将会进行消元操作，消元完成后我们会利用回带的方式求出方程的解。

消元的基本步骤是使用一个方程的k倍与另外一行相加，使得矩阵内的0元增加，这样我们就可以更方便地使用剩下的元素对方程进行求解。

首先先用第二行减去两倍的第一行，我们可以得到：

$$
\begin{bmatrix}
    1 & 2 & 3 & 9 \\
    0 & -3 & -4 & -10 \\
    1 & 1 & 1 & 5
\end{bmatrix}
$$

这样第二个方程就少了一维未知变量，更容易进行求解。

回顾上面的矩阵乘法，我们不难发现上面的操作其实等价于：

$$
\begin{bmatrix}
    1 & 2 & 3 & 9 \\
    0 & -3 & -4 & -10 \\
    1 & 1 & 1 & 5
\end{bmatrix}
=
\begin{bmatrix}
    1 & 0 & 0 \\
    -2 & 1 & 0  \\
    0 & 0 & 1 
\end{bmatrix}
\begin{bmatrix}
    1 & 2 & 3 & 9 \\
    2 & 1 & 2 & 8 \\
    1 & 1 & 1 & 5
\end{bmatrix}
$$

其中

$$
\begin{bmatrix}
    1 & 0 & 0 \\
    -2 & 1 & 0  \\
    0 & 0 & 1 
\end{bmatrix}
$$

这个矩阵由

$$
\begin{bmatrix}
    1 & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1 
\end{bmatrix}
$$

修改了一个值得到。上面的这个矩阵我们称为单位矩阵(一般记作I)，它的特性在于在任何矩阵乘法中它对另外的矩阵没有任何影响（试着用矩阵乘法的原理解释），或者说它是矩阵乘法的单位元。
由这个矩阵修改得到的新矩阵我们称为初等矩阵(一般记作E，也可以理解为消元矩阵)。初等矩阵的作用是将矩阵的某一行（或者某一列）的k倍加到另一行（或者另一列）上。

我们省略的中间其他的消元步骤，只给出最后的结果：

$$
\begin{bmatrix}
    1 & 2 & 3 & 9 \\
    0 & -3 & -4 & -10 \\
    0 & 0 & -\frac{2}{3} & -\frac{2}{3}
\end{bmatrix}
$$

其中我们的系数矩阵已经变成了

$$
\begin{bmatrix}
    1 & 2 & 3 \\
    0 & -3 & -4 \\
    0 & 0 & -\frac{2}{3}
\end{bmatrix}
$$

这是一个非常优雅的形式。对角线以下的部分全部为0！这样的矩阵我们称为上三角矩阵，也是我们消元的终极目的。

接下来我们完成回带操作：

+ 由矩阵的最后一行我们可以得到 $z = 1$
+ 将 $z = 1$ 带入到第二行，我们可以再求出 $y = 2$
+ 将两个求出的值都带入第一行，得到 $x = 2$

这样我们解方程的步骤就全部结束了。这个算法被命名为**高斯消元**。

你可能会注意到：如果矩阵中任何一个 $a_{ii}$ 元素为0，我们就无法求出方程组的解。这些对角线上的元素我们称之为主元。
如果在消元时主元为0,我们可以尝试着将该行与下面的行进行交换，从而修复这个问题。如果无法通过交换解决，说明该方程组无解。

> 关于判定方程组无解的方法，你可能已经听说过了行列式的概念。但我（包括一些教程和教材）并不主张在一开始就提出行列式。这样的教学顺序并不是循序渐进的，不利于理解和消化。

> 你可能也发现了，这个方程组来源于上面矩阵乘法的例子。如果没有，说明你的注意力可能还不是非常集中XD。

## 矩阵的逆
我们之前提到过：矩阵乘法的实质是对向量进行线性组合。那么我们能不能找到一个线性组合的逆运算呢？

如果对于矩阵乘法 $AB$ ，我们可以找到一个矩阵 $A^{-1}$ ，使得 $A^{-1}AB = B$ ，那么我们称 $A^{-1}$ 为矩阵 $A$ 的逆矩阵。
也可以说，如果 $A^{-1}A = AA^{-1} = I$ ，那么 $A^{-1}$ 为矩阵 $A$ 的逆矩阵。

矩阵求逆需要用到和消元类似的方式，只不过我们不再只使用一个向量，而是将单位矩阵与原矩阵合并：

$$
\begin{bmatrix}
    1 & 2 & 2 & 1 & 0 & 0 \\
    2 & 5 & 2 & 0 & 1 & 0 \\
    1 & 1 & 2 & 0 & 0 & 1
\end{bmatrix}
$$

我们现在消元的目的在于将左半矩阵变为单位矩阵，那么右半的矩阵就是我们所需要的 $A^{-1}$ 。
这种做法被称为**高斯-若尔当**算法，其基本思路就是如果 $AA^{-1} = I$ ，我们不妨用消元的思路在两侧同时乘上 $A^{-1}$ ，这样右侧的单位矩阵就会变为答案。

为了节省版面和流量，我们这里也只给出消元的最终结果：

$$
\begin{bmatrix}
    1 & 0 & 0 & -4 & 1 & 3 \\
    0 & 1 & 0 & 1 & 0 & -1 \\
    0 & 0 & 1 & \frac{3}{2} & -\frac{1}{2} & -\frac{1}{2}
\end{bmatrix}
$$

你可以将结果与原矩阵相乘来验证你的计算是否正确。

有一些特殊的矩阵并不需要我们专门做这么复杂的计算:

+ 单位矩阵I的逆矩阵就是其本身
+ 初等矩阵E的逆矩阵只需将修改过的元素取反，例如

$$
\begin{bmatrix}
    1 & 0 & 0 \\
    -2 & 1 & 0  \\
    0 & 0 & 1 
\end{bmatrix}
$$

这个矩阵的逆矩阵为

$$
\begin{bmatrix}
    1 & 0 & 0 \\
    2 & 1 & 0  \\
    0 & 0 & 1 
\end{bmatrix}
$$

你可以借助消元的思想验证它的正确性

+ $(AB)^{-1} = B^{-1}A^{-1}$ ，只需将矩阵相乘即可验证
+ $(A^T)^{-1}=(A^{-1})^T$ ，只需将矩阵相乘即可验证

由于求逆的算法本质还是消元，所以无法消元的矩阵自然也不存在逆矩阵。我们将会在之后的内容中看到如何不进行消元，从而判断矩阵是否可逆。

## 参考资料
+ [矩阵- 维基百科，自由的百科全书](https://zh.wikipedia.org/wiki/%E7%9F%A9%E9%98%B5)
+ [麻省理工公开课：线性代数](https://open.163.com/newview/movie/courseintro?newurl=M6V0BQC4M)